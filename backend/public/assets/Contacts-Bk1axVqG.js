import{d as te,r as b,i as S,c as n,a as e,F as R,b as F,n as G,s as k,f as _,t as u,x as se,h as r,o as Se,q as ee,A as Ee,B as Ae,j as w,v as I,l as W,e as D,k as Ue}from"./index-D6DdudHB.js";import{f as Ve,v as Ne}from"./phoneValidator-nfOHmQze.js";import{u as Ie}from"./contacts-IDtDDakD.js";import{u as Pe}from"./groups-BJ29z54-.js";import{u as Le}from"./messages-DMCdku8F.js";const Me={class:"overflow-x-auto"},Te={class:"min-w-full divide-y divide-gray-200"},Be={class:"bg-gray-50"},je={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},De=["checked"],Re={class:"bg-white divide-y divide-gray-200"},Fe={key:0},Ge={key:1},qe=["onClick"],ze=["checked","onChange"],Oe={class:"px-6 py-4 text-sm font-medium text-gray-900 max-w-xs"},We={class:"flex items-center gap-1"},He=["title"],Qe=["onClick"],Je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ye={class:"px-6 py-4 text-sm text-gray-500 max-w-xs"},Ze={key:0,class:"flex items-center gap-1"},et=["title"],tt=["onClick"],st={key:1,class:"text-gray-400"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ot={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},at={key:1,class:"text-gray-400"},nt={class:"px-6 py-4 whitespace-nowrap text-sm"},rt={key:0,class:"text-gray-400"},dt={key:1,class:"flex items-center gap-2"},it={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},ut={key:1,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800"},ct={key:2,class:"text-xs text-blue-600",title:"In your WhatsApp contacts"},pt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},vt={class:"flex items-center gap-3"},mt=["onClick"],xt=["onClick"],gt=["onClick"],bt=te({__name:"ContactTable",props:{contacts:{},loading:{type:Boolean},selectedIds:{}},emits:["select","select-all","edit","delete"],setup(M,{emit:H}){const v=se(),P=M,q=H,E=b({}),A=b({}),B=S(()=>P.contacts.length>0&&P.contacts.every(p=>P.selectedIds.includes(p.id)));function x(p){return Ve(p)}function m(p,i){i==="name"?E.value[p]=!E.value[p]:A.value[p]=!A.value[p]}function d(p){if(p.sent_count&&p.sent_count>0)v.push(`/contacts/${p.id}/history`);else{const i=P.selectedIds.includes(p.id);q("select",p.id,!i)}}function L(p){v.push({path:"/messages",query:{contactIds:p.id.toString(),messageType:"email"}})}return(p,i)=>(r(),n("div",Me,[e("table",Te,[e("thead",Be,[e("tr",null,[e("th",je,[e("input",{type:"checkbox",checked:B.value,onChange:i[0]||(i[0]=s=>p.$emit("select-all",s.target.checked)),class:"rounded border-gray-300"},null,40,De)]),i[2]||(i[2]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name ",-1)),i[3]||(i[3]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Phone ",-1)),i[4]||(i[4]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),i[5]||(i[5]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Group ",-1)),i[6]||(i[6]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Business ",-1)),i[7]||(i[7]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Messages ",-1)),i[8]||(i[8]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," WAStatus ",-1)),i[9]||(i[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",Re,[M.loading?(r(),n("tr",Fe,[...i[10]||(i[10]=[e("td",{colspan:"9",class:"px-6 py-4 text-center text-gray-500"}," Loading... ",-1)])])):M.contacts.length===0?(r(),n("tr",Ge,[...i[11]||(i[11]=[e("td",{colspan:"9",class:"px-6 py-4 text-center text-gray-500"}," No contacts found ",-1)])])):(r(!0),n(R,{key:2},F(M.contacts,s=>(r(),n("tr",{key:s.id,class:G(["hover:bg-gray-50",{"cursor-pointer":s.sent_count&&s.sent_count>0}]),onClick:f=>d(s)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:i[1]||(i[1]=k(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:M.selectedIds.includes(s.id),onChange:f=>p.$emit("select",s.id,f.target.checked),class:"rounded border-gray-300 cursor-pointer"},null,40,ze)]),e("td",Oe,[e("div",We,[e("span",{class:G({truncate:!E.value[s.id]}),title:E.value[s.id]?"":s.name},u(s.name),11,He),s.name&&s.name.length>20?(r(),n("button",{key:0,onClick:k(f=>m(s.id,"name"),["stop"]),class:"text-blue-600 hover:text-blue-800 text-xs cursor-pointer flex-shrink-0"},u(E.value[s.id]?"Hide":"Show"),9,Qe)):_("",!0)])]),e("td",Je,u(x(s.phone)),1),e("td",Ke,u(s.email||"-"),1),e("td",Xe,u(s.group_name||"-"),1),e("td",Ye,[s.business?(r(),n("div",Ze,[e("span",{class:G({truncate:!A.value[s.id]}),title:A.value[s.id]?"":s.business},u(s.business),11,et),s.business.length>20?(r(),n("button",{key:0,onClick:k(f=>m(s.id,"business"),["stop"]),class:"text-blue-600 hover:text-blue-800 text-xs cursor-pointer flex-shrink-0"},u(A.value[s.id]?"Hide":"Show"),9,tt)):_("",!0)])):(r(),n("span",st,"-"))]),e("td",lt,[s.sent_count&&s.sent_count>0?(r(),n("span",ot," Sent ("+u(s.sent_count)+") ",1)):(r(),n("span",at,"-"))]),e("td",nt,[s.whatsapp_valid===null||s.whatsapp_valid===void 0?(r(),n("div",rt," Not checked ")):(r(),n("div",dt,[s.whatsapp_valid===1?(r(),n("span",it," âœ“ Valid ")):(r(),n("span",ut," âœ— Invalid ")),s.whatsapp_in_contacts===1?(r(),n("span",ct," ðŸ“± ")):_("",!0)]))]),e("td",pt,[e("div",vt,[s.email?(r(),n("button",{key:0,onClick:k(f=>L(s),["stop"]),class:"text-green-600 hover:text-green-900 cursor-pointer",title:"Send Email"}," ðŸ“§ Email ",8,mt)):_("",!0),e("button",{onClick:k(f=>p.$emit("edit",s),["stop"]),class:"text-blue-600 hover:text-blue-900 cursor-pointer"}," Edit ",8,xt),e("button",{onClick:k(f=>p.$emit("delete",s.id),["stop"]),class:"text-red-600 hover:text-red-900 cursor-pointer"}," Delete ",8,gt)])])],10,qe))),128))])])]))}}),yt={class:"px-4 py-6 sm:px-0"},ft={class:"mb-6 flex justify-between items-center"},ht={class:"flex gap-2"},wt={class:"bg-white shadow rounded-lg p-6 mb-6"},_t={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},kt=["value"],Ct={class:"bg-white shadow rounded-lg overflow-hidden"},$t={key:0,class:"px-6 py-4 border-t border-gray-200"},St={class:"flex items-center justify-between flex-wrap gap-4"},Et={class:"flex items-center gap-4"},At={class:"text-sm text-gray-700"},Ut={key:0},Vt={key:1},Nt={class:"flex items-center gap-2"},It={key:0,class:"flex gap-2"},Pt=["disabled"],Lt={class:"px-3 py-1 text-sm text-gray-700"},Mt=["disabled"],Tt={key:0,class:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},Bt={class:"flex items-center justify-between"},jt={class:"text-sm font-medium text-blue-900"},Dt={class:"flex gap-2"},Rt=["disabled"],Ft=["disabled"],Gt=["disabled"],qt={class:"mt-6 flex justify-end gap-2"},zt=["disabled"],Ot=["disabled"],Wt=["disabled"],Ht={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Qt={class:"mt-3"},Jt={class:"space-y-4"},Kt={key:0,class:"mt-1 text-xs text-red-600"},Xt={key:1,class:"mt-1 text-xs text-gray-500"},Yt=["value"],Zt={class:"flex justify-end gap-2 mt-6"},es=["disabled"],ts={class:"relative top-20 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white"},ss={class:"mt-3"},ls={class:"space-y-4"},os={class:"grid grid-cols-3 gap-4 mb-4"},as={class:"bg-blue-50 p-3 rounded"},ns={class:"text-2xl font-bold text-blue-600"},rs={class:"bg-green-50 p-3 rounded"},ds={class:"text-2xl font-bold text-green-600"},is={class:"bg-red-50 p-3 rounded"},us={class:"text-2xl font-bold text-red-600"},cs={key:0,class:"bg-yellow-50 p-3 rounded"},ps={class:"text-lg font-semibold text-yellow-600"},vs={key:1,class:"mt-4"},ms={class:"max-h-60 overflow-y-auto border border-red-200 rounded"},xs={class:"min-w-full divide-y divide-red-200"},gs={class:"bg-white divide-y divide-red-200"},bs={class:"px-4 py-2 text-sm"},ys={class:"px-4 py-2 text-sm"},fs={class:"px-4 py-2 text-sm text-red-600"},hs={class:"flex justify-end mt-6"},ws={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},_s={class:"mt-3"},ks={class:"space-y-4"},Cs={key:0,class:"mt-1 text-xs text-red-600"},$s={key:1,class:"mt-1 text-xs text-gray-500"},Ss=["value"],Es={class:"flex justify-end gap-2 mt-6"},As=["disabled"],Ls=te({__name:"Contacts",setup(M){const H=se(),v=Ie(),P=Pe(),q=Le(),E=b(""),A=b(null),B=b(""),x=b([]),m=b(0),d=b(20),L=b(!1),p=b(!1),i=b(!1),s=b(null),f=b(null),T=b(null),U=b(!1),V=b(!1),N=b(!1),j=b(!1),C=b(null),y=b({name:"",phone:"",group_id:null,business:""}),z=S(()=>v.contacts),Q=S(()=>P.groups),le=S(()=>v.loading),h=S(()=>v.total),oe=S(()=>d.value===0?1:Math.floor(m.value/d.value)+1),ae=S(()=>d.value===0?1:Math.ceil(h.value/d.value)),ne=S(()=>d.value===0?!1:m.value+z.value.length<h.value),re=S(()=>h.value===0?0:m.value+1),de=S(()=>m.value+z.value.length);Se(async()=>{await P.fetchGroups(),await v.fetchContacts(d.value||100,0)});function ie(){v.setFilters({search:E.value}),m.value=0;const a=d.value===0?1e4:d.value;v.fetchContacts(a,0)}function J(){v.setFilters({groupId:A.value,business:B.value}),m.value=0;const a=d.value===0?1e4:d.value;v.fetchContacts(a,0)}function ue(){m.value=0;const a=d.value===0?1e4:d.value;v.fetchContacts(a,0)}function ce(a,t){t?x.value.includes(a)||x.value.push(a):x.value=x.value.filter(o=>o!==a)}function pe(a){a?x.value=z.value.map(t=>t.id):x.value=[]}function ve(a){const t=a.phone.startsWith("40")&&a.phone.length===10?a.phone.substring(2):a.phone;s.value={...a,phone:t},T.value=null,p.value=!0}async function me(a){var t,o;if(confirm("Are you sure you want to delete this contact?"))try{await v.deleteContact(a);const c=d.value===0?1e4:d.value;await v.fetchContacts(c,m.value)}catch(c){alert("Error deleting contact: "+(((o=(t=c.response)==null?void 0:t.data)==null?void 0:o.error)||c.message))}}async function xe(){var a,t;if(x.value.length===0){alert("Please select contacts to validate");return}U.value=!0;try{const o=await D.post("/api/contacts/validate",{contactIds:x.value});C.value=o.data,j.value=!0;const c=d.value===0?1e4:d.value;await v.fetchContacts(c,m.value)}catch(o){alert("Error validating contacts: "+(((t=(a=o.response)==null?void 0:a.data)==null?void 0:t.error)||o.message))}finally{U.value=!1}}async function ge(){var a,t;if(confirm("This will validate all contacts. Continue?")){U.value=!0;try{const o=await D.post("/api/contacts/validate",{});C.value=o.data,j.value=!0;const c=d.value===0?1e4:d.value;await v.fetchContacts(c,m.value)}catch(o){alert("Error validating contacts: "+(((t=(a=o.response)==null?void 0:a.data)==null?void 0:t.error)||o.message))}finally{U.value=!1}}}async function be(){var a,t;if(x.value.length===0){alert("Please select contacts to export");return}N.value=!0;try{const o=x.value.join(","),c=await D.get("/api/contacts/export",{params:{contactIds:o},responseType:"blob"}),g=window.URL.createObjectURL(new Blob([c.data])),$=document.createElement("a");$.href=g,$.setAttribute("download",`contacts-selected-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild($),$.click(),$.remove(),window.URL.revokeObjectURL(g)}catch(o){console.error("Error exporting contacts:",o),alert("Error exporting contacts: "+(((t=(a=o.response)==null?void 0:a.data)==null?void 0:t.error)||o.message))}finally{N.value=!1}}async function ye(){var a,t;if(h.value===0){alert("No contacts to export");return}if(confirm(`Export all ${h.value} contacts to Gmail CSV format?`)){N.value=!0;try{const o=await D.get("/api/contacts/export",{responseType:"blob"}),c=window.URL.createObjectURL(new Blob([o.data])),g=document.createElement("a");g.href=c,g.setAttribute("download",`contacts-all-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(c)}catch(o){console.error("Error exporting contacts:",o),alert("Error exporting contacts: "+(((t=(a=o.response)==null?void 0:a.data)==null?void 0:t.error)||o.message))}finally{N.value=!1}}}async function fe(){var a,t;if(x.value.length===0){alert("Please select contacts to delete");return}if(confirm(`Are you sure you want to delete ${x.value.length} selected contact(s)? This action cannot be undone.`)){V.value=!0;try{await v.deleteContacts(x.value),x.value=[];const o=d.value===0?1e4:d.value;await v.fetchContacts(o,m.value),alert("Selected contacts deleted successfully")}catch(o){alert("Error deleting contacts: "+(((t=(a=o.response)==null?void 0:a.data)==null?void 0:t.error)||o.message))}finally{V.value=!1}}}async function he(){var o,c;if(h.value===0){alert("No contacts to delete");return}const a=`Are you sure you want to delete ALL ${h.value} contacts? This action cannot be undone. Type "DELETE ALL" to confirm.`;if(prompt(a)==="DELETE ALL"){V.value=!0;try{const g=await v.deleteAllContacts();x.value=[];const $=d.value===0?1e4:d.value;await v.fetchContacts($,m.value),alert(`Successfully deleted ${g} contact(s)`)}catch(g){alert("Error deleting all contacts: "+(((c=(o=g.response)==null?void 0:o.data)==null?void 0:c.error)||g.message))}finally{V.value=!1}}}function we(){d.value!==0&&(m.value+=d.value,v.fetchContacts(d.value,m.value))}function _e(){d.value!==0&&(m.value=Math.max(0,m.value-d.value),v.fetchContacts(d.value,m.value))}function ke(){q.setTemplate(q.template),H.push({path:"/messages",query:{contactIds:x.value.join(",")}})}function O(a){var c;const t=a==="new"?y.value.phone:((c=s.value)==null?void 0:c.phone)||"",o=Ne(t);return a==="new"?f.value=o.valid?null:o.error:T.value=o.valid?null:o.error,o.valid}async function Ce(){var a,t,o;if(!y.value.name||!y.value.phone){alert("Name and phone are required");return}if(O("new")){i.value=!0;try{await D.post("/api/contacts",{name:y.value.name.trim(),phone:y.value.phone,group_id:y.value.group_id,business:((a=y.value.business)==null?void 0:a.trim())||null});const c=d.value===0?1e4:d.value;await v.fetchContacts(c,m.value),y.value={name:"",phone:"",group_id:null,business:""},f.value=null,L.value=!1}catch(c){const g=((o=(t=c.response)==null?void 0:t.data)==null?void 0:o.error)||c.message;alert("Error adding contact: "+g),console.error("Add contact error:",c)}finally{i.value=!1}}}async function $e(){var a,t,o;if(!s.value||!s.value.name||!s.value.phone){alert("Name and phone are required");return}if(O("edit")){i.value=!0;try{await v.updateContact(s.value.id,{name:s.value.name.trim(),phone:s.value.phone,group_id:s.value.group_id,business:((a=s.value.business)==null?void 0:a.trim())||null});const c=d.value===0?1e4:d.value;await v.fetchContacts(c,m.value),p.value=!1,s.value=null,T.value=null}catch(c){const g=((o=(t=c.response)==null?void 0:t.data)==null?void 0:o.error)||c.message;alert("Error updating contact: "+g),console.error("Update contact error:",c)}finally{i.value=!1}}}return(a,t)=>{var c,g,$,K,X,Y,Z;const o=Ae("router-link");return r(),n("div",yt,[e("div",ft,[t[23]||(t[23]=e("div",null,[e("h2",{class:"text-3xl font-bold text-gray-900"},"Contacts"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage your imported contacts")],-1)),e("div",ht,[e("button",{onClick:t[0]||(t[0]=l=>L.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer"}," + Add Contact "),ee(o,{to:"/upload",class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer"},{default:Ee(()=>[...t[22]||(t[22]=[Ue(" + Import Contacts ",-1)])]),_:1})])]),e("div",wt,[e("div",_t,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),w(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=l=>E.value=l),placeholder:"Search by name, phone, or business...",class:"w-full border border-gray-300 rounded-md px-3 py-2",onInput:ie},null,544),[[I,E.value]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Group",-1)),w(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>A.value=l),class:"w-full border border-gray-300 rounded-md px-3 py-2",onChange:J},[t[25]||(t[25]=e("option",{value:null},"All Groups",-1)),(r(!0),n(R,null,F(Q.value,l=>(r(),n("option",{key:l.id,value:l.id},u(l.name),9,kt))),128))],544),[[W,A.value]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Business",-1)),w(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=l=>B.value=l),placeholder:"Filter by business...",class:"w-full border border-gray-300 rounded-md px-3 py-2",onInput:J},null,544),[[I,B.value]])])])]),e("div",Ct,[ee(bt,{contacts:z.value,loading:le.value,"selected-ids":x.value,onSelect:ce,onSelectAll:pe,onEdit:ve,onDelete:me},null,8,["contacts","loading","selected-ids"]),h.value>0?(r(),n("div",$t,[e("div",St,[e("div",Et,[e("div",At,[d.value===0?(r(),n("span",Ut,"Showing all "+u(h.value)+" contacts",1)):(r(),n("span",Vt,"Showing "+u(re.value)+" to "+u(de.value)+" of "+u(h.value)+" contacts",1))]),e("div",Nt,[t[29]||(t[29]=e("label",{class:"text-sm text-gray-700"},"Show:",-1)),w(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>d.value=l),onChange:ue,class:"border border-gray-300 rounded-md px-2 py-1 text-sm cursor-pointer"},[...t[28]||(t[28]=[e("option",{value:20},"20",-1),e("option",{value:50},"50",-1),e("option",{value:0},"All",-1)])],544),[[W,d.value]])])]),d.value>0?(r(),n("div",It,[e("button",{onClick:_e,disabled:m.value===0,class:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"}," Previous ",8,Pt),e("span",Lt," Page "+u(oe.value)+" of "+u(ae.value),1),e("button",{onClick:we,disabled:!ne.value,class:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"}," Next ",8,Mt)])):_("",!0)])])):_("",!0)]),x.value.length>0?(r(),n("div",Tt,[e("div",Bt,[e("span",jt,u(x.value.length)+" contact(s) selected ",1),e("div",Dt,[e("button",{onClick:xe,disabled:U.value,class:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(U.value?"Validating...":"Validate Selected"),9,Rt),e("button",{onClick:be,disabled:N.value,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(N.value?"Exporting...":"Export Selected"),9,Ft),e("button",{onClick:fe,disabled:V.value,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(V.value?"Deleting...":"Delete Selected"),9,Gt),e("button",{onClick:ke,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer"}," Send Message "),e("button",{onClick:t[5]||(t[5]=l=>x.value=[]),class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer"}," Clear Selection ")])])])):_("",!0),e("div",qt,[e("button",{onClick:ge,disabled:U.value,class:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(U.value?"Validating...":"Validate All Contacts"),9,zt),e("button",{onClick:ye,disabled:N.value||h.value===0,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(N.value?"Exporting...":"Export All Contacts"),9,Ot),e("button",{onClick:he,disabled:V.value||h.value===0,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(V.value?"Deleting...":"Delete All Contacts"),9,Wt)]),L.value?(r(),n("div",{key:1,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:t[12]||(t[12]=k(l=>L.value=!1,["self"]))},[e("div",Ht,[e("div",Qt,[t[35]||(t[35]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Add New Contact",-1)),e("form",{onSubmit:k(Ce,["prevent"])},[e("div",Jt,[e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Name *",-1)),w(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>y.value.name=l),type:"text",required:"",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Full name"},null,512),[[I,y.value.name]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Phone *",-1)),w(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>y.value.phone=l),type:"text",required:"",class:G(["w-full border border-gray-300 rounded-md px-3 py-2",{"border-red-500":f.value}]),placeholder:"e.g., 712345678 or 0712345678",onBlur:t[8]||(t[8]=l=>O("new"))},null,34),[[I,y.value.phone]]),f.value?(r(),n("p",Kt,u(f.value),1)):(r(),n("p",Xt," Enter 9 digits (e.g., 712345678) or 10 digits with leading 0 (e.g., 0712345678). Country code 40 will be added automatically. "))]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Group",-1)),w(e("select",{"onUpdate:modelValue":t[9]||(t[9]=l=>y.value.group_id=l),class:"w-full border border-gray-300 rounded-md px-3 py-2"},[t[32]||(t[32]=e("option",{value:null},"-- No Group --",-1)),(r(!0),n(R,null,F(Q.value,l=>(r(),n("option",{key:l.id,value:l.id},u(l.name),9,Yt))),128))],512),[[W,y.value.group_id]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Business",-1)),w(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>y.value.business=l),type:"text",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Business/Institution"},null,512),[[I,y.value.business]])])]),e("div",Zt,[e("button",{type:"button",onClick:t[11]||(t[11]=l=>L.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Cancel "),e("button",{type:"submit",disabled:i.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(i.value?"Adding...":"Add Contact"),9,es)])],32)])])])):_("",!0),j.value?(r(),n("div",{key:2,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:t[14]||(t[14]=k(l=>j.value=!1,["self"]))},[e("div",ts,[e("div",ss,[t[42]||(t[42]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Validation Results",-1)),e("div",ls,[e("div",os,[e("div",as,[t[36]||(t[36]=e("div",{class:"text-sm text-gray-600"},"Total",-1)),e("div",ns,u(((c=C.value)==null?void 0:c.total)||0),1)]),e("div",rs,[t[37]||(t[37]=e("div",{class:"text-sm text-gray-600"},"Valid",-1)),e("div",ds,u(((g=C.value)==null?void 0:g.valid)||0),1)]),e("div",is,[t[38]||(t[38]=e("div",{class:"text-sm text-gray-600"},"Invalid",-1)),e("div",us,u((($=C.value)==null?void 0:$.invalid)||0),1)])]),((K=C.value)==null?void 0:K.updated)>0?(r(),n("div",cs,[t[39]||(t[39]=e("div",{class:"text-sm text-gray-600"},"Updated",-1)),e("div",ps,u(C.value.updated)+" contact(s) were updated with corrected phone numbers",1)])):_("",!0),((Z=(Y=(X=C.value)==null?void 0:X.results)==null?void 0:Y.invalid)==null?void 0:Z.length)>0?(r(),n("div",vs,[t[41]||(t[41]=e("h4",{class:"font-medium text-red-600 mb-2"},"Invalid Contacts:",-1)),e("div",ms,[e("table",xs,[t[40]||(t[40]=e("thead",{class:"bg-red-50"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-red-700"},"Name"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-red-700"},"Phone"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-red-700"},"Error")])],-1)),e("tbody",gs,[(r(!0),n(R,null,F(C.value.results.invalid,l=>(r(),n("tr",{key:l.id},[e("td",bs,u(l.name),1),e("td",ys,u(l.phone),1),e("td",fs,u(l.error),1)]))),128))])])])])):_("",!0)]),e("div",hs,[e("button",{onClick:t[13]||(t[13]=l=>{j.value=!1,C.value=null}),class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer"}," Close ")])])])])):_("",!0),p.value&&s.value?(r(),n("div",{key:3,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:t[21]||(t[21]=k(l=>p.value=!1,["self"]))},[e("div",ws,[e("div",_s,[t[48]||(t[48]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Contact",-1)),e("form",{onSubmit:k($e,["prevent"])},[e("div",ks,[e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Name *",-1)),w(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>s.value.name=l),type:"text",required:"",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Full name"},null,512),[[I,s.value.name]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Phone *",-1)),w(e("input",{"onUpdate:modelValue":t[16]||(t[16]=l=>s.value.phone=l),type:"text",required:"",class:G(["w-full border border-gray-300 rounded-md px-3 py-2",{"border-red-500":T.value}]),placeholder:"e.g., 712345678 or 0712345678",onBlur:t[17]||(t[17]=l=>O("edit"))},null,34),[[I,s.value.phone]]),T.value?(r(),n("p",Cs,u(T.value),1)):(r(),n("p",$s," Enter 9 digits (e.g., 712345678) or 10 digits with leading 0 (e.g., 0712345678). Country code 40 will be added automatically. "))]),e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Group",-1)),w(e("select",{"onUpdate:modelValue":t[18]||(t[18]=l=>s.value.group_id=l),class:"w-full border border-gray-300 rounded-md px-3 py-2"},[t[45]||(t[45]=e("option",{value:null},"-- No Group --",-1)),(r(!0),n(R,null,F(Q.value,l=>(r(),n("option",{key:l.id,value:l.id},u(l.name),9,Ss))),128))],512),[[W,s.value.group_id]])]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Business",-1)),w(e("input",{"onUpdate:modelValue":t[19]||(t[19]=l=>s.value.business=l),type:"text",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Business/Institution"},null,512),[[I,s.value.business]])])]),e("div",Es,[e("button",{type:"button",onClick:t[20]||(t[20]=l=>{p.value=!1,s.value=null}),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Cancel "),e("button",{type:"submit",disabled:i.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},u(i.value?"Updating...":"Update Contact"),9,As)])],32)])])])):_("",!0)])}}});export{Ls as default};
