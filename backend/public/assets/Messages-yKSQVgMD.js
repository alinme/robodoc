import{d as ye,r as p,i as T,c as o,a as t,t as d,h as n,F as W,b as V,f as h,n as fe,w as _e,o as Ge,j as G,v as ue,e as P,s as Z,C as Je,q as me,A as Xe,B as Ze,l as ge,y as ve,z as et,k as Te,g as tt,D as Ee,p as st}from"./index-D6DdudHB.js";import{u as lt}from"./messages-DMCdku8F.js";import{u as at}from"./groups-BJ29z54-.js";import{u as ot}from"./contacts-IDtDDakD.js";import{u as nt}from"./whatsapp-DcciMMEC.js";import{u as rt}from"./templates-TDtG4Si1.js";import{f as it}from"./phoneValidator-nfOHmQze.js";const ut=["value","disabled"],dt={class:"mt-2 text-sm text-gray-500"},ct=ye({__name:"MessageEditor",props:{template:{},disabled:{type:Boolean}},emits:["update:template"],setup(z,{expose:q,emit:f}){const v=z,y=f,C=p(null),F=T(()=>v.template.length);function k(R){const j=R.target;y("update:template",j.value)}function I(R){if(!C.value)return;const j=C.value;j.focus();const b=j.selectionStart||0,r=j.selectionEnd||b,U=v.template||"",B=U.substring(0,b)+R+U.substring(r);y("update:template",B),setTimeout(()=>{if(C.value){C.value.focus();const N=b+R.length;C.value.setSelectionRange(N,N)}},10)}return q({insertPlaceholder:I}),(R,j)=>(n(),o("div",null,[t("textarea",{ref_key:"textareaRef",ref:C,value:z.template,onInput:k,disabled:z.disabled,rows:"10",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter your message template here..."},null,40,ut),t("div",dt,d(F.value)+" characters ",1)]))}}),pt={class:"overflow-x-auto"},mt={class:"min-w-full divide-y divide-gray-200"},gt={class:"bg-white divide-y divide-gray-200"},vt={key:0},ft={class:"px-6 py-4 whitespace-nowrap text-sm"},yt={class:"font-medium text-gray-900"},xt={class:"text-gray-500"},ht={class:"px-6 py-4 text-sm text-gray-500"},bt={class:"max-w-md"},wt={class:"truncate"},_t={key:0,class:"mt-2 flex flex-wrap gap-2"},kt=["href","title"],$t={class:"px-6 py-4 whitespace-nowrap"},Ct={class:"space-y-1"},St={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},At={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Mt=["onClick"],Tt={key:1,class:"text-gray-400"},Et=ye({__name:"MessageHistory",props:{messages:{}},emits:["retry","delete"],setup(z){return(q,f)=>(n(),o("div",pt,[t("table",mt,[f[2]||(f[2]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contact "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Message / Attachments "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type / Status "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Sent At "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",gt,[z.messages.length===0?(n(),o("tr",vt,[...f[0]||(f[0]=[t("td",{colspan:"5",class:"px-6 py-4 text-center text-gray-500"}," No messages sent yet ",-1)])])):(n(!0),o(W,{key:1},V(z.messages,v=>(n(),o("tr",{key:v.id,class:"hover:bg-gray-50"},[t("td",ft,[t("div",yt,d(v.contact_name||"-"),1),t("div",xt,d(v.phone||"-"),1)]),t("td",ht,[t("div",bt,[t("div",wt,d(v.final_message||v.message_content),1),v.attachments&&v.attachments.length>0?(n(),o("div",_t,[(n(!0),o(W,null,V(v.attachments,y=>(n(),o("a",{key:y.id,href:`/api/attachments/${y.id}`,target:"_blank",class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs hover:bg-blue-100 cursor-pointer",title:y.original_filename}," ðŸ“Ž "+d(y.original_filename),9,kt))),128))])):h("",!0)])]),t("td",$t,[t("div",Ct,[t("span",{class:fe(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",v.message_type==="email"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"])},d(v.message_type||"whatsapp"),3),f[1]||(f[1]=t("br",null,null,-1)),t("span",{class:fe(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",v.status==="sent"?"bg-green-100 text-green-800":v.status==="failed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},d(v.status),3)])]),t("td",St,d(v.sent_at?new Date(v.sent_at).toLocaleString():"-"),1),t("td",At,[v.status==="failed"?(n(),o("button",{key:0,onClick:y=>q.$emit("retry",v.id),class:"text-blue-600 hover:text-blue-900 cursor-pointer"}," Retry ",8,Mt)):(n(),o("span",Tt,"-"))])]))),128))])])]))}}),Gt={class:"space-y-4"},Pt={class:"mb-4"},Ft={class:"flex items-center gap-2 text-sm"},Dt={key:0,class:"text-gray-400"},jt=["onClick"],Bt={key:0,class:"text-gray-400"},It={key:0,class:"text-center py-8 text-gray-500"},Nt={key:1,class:"text-center py-8 text-gray-500"},Wt={key:2,class:"border border-gray-200 rounded-md max-h-96 overflow-y-auto"},Rt={class:"min-w-full divide-y divide-gray-200"},Ut={class:"bg-gray-50 sticky top-0"},Lt={class:"px-4 py-2 text-left"},Vt=["checked"],zt={class:"bg-white divide-y divide-gray-200"},qt={key:0},Ht={colspan:"4",class:"px-4 py-8 text-center text-gray-500"},Kt=["checked","onChange"],Ot={class:"px-4 py-2"},Qt={class:"flex items-center gap-2"},Yt={class:"text-lg"},Jt=["onClick"],Xt={key:1,class:"text-gray-900"},Zt={class:"px-4 py-2 text-sm text-gray-500"},es={class:"px-4 py-2 text-sm text-gray-500"},ts={key:3,class:"mt-4 p-3 bg-blue-50 rounded-md"},ss={class:"text-sm text-blue-800"},ls=ye({__name:"StorageBrowser",props:{selectedFiles:{}},emits:["file-selected"],setup(z,{emit:q}){const f=z,v=q,y=p(""),C=p([]),F=p(!1),k=p([]),I=p(""),R=p([]),j=T(()=>y.value?y.value.split("/").filter(i=>i):[]),b=T(()=>{const i=r.value.filter(u=>!u.isDirectory);return i.length>0&&i.every(u=>B(u))}),r=T(()=>{if(!I.value.trim())return C.value;const i=I.value.toLowerCase().trim();return C.value.filter(u=>u.name.toLowerCase().includes(i))});function U(i){return i<0?"":j.value.slice(0,i+1).join("/")}function B(i){return k.value.some(u=>u.path===i.path)}function N(i){if(i.isDirectory)return;const u=k.value.findIndex(c=>c.path===i.path);u>=0?k.value.splice(u,1):k.value.push(i),v("file-selected",k.value)}function H(){const i=r.value.filter(u=>!u.isDirectory);b.value?k.value=k.value.filter(u=>!i.some(c=>c.path===u.path)):i.forEach(u=>{B(u)||k.value.push(u)}),v("file-selected",k.value)}async function ee(){var i,u;F.value=!0;try{const c=await P.get("/api/storage",{params:{folderPath:y.value}});C.value=c.data.items||[],R.value=C.value,y.value?localStorage.setItem("storageBrowser_currentPath",y.value):localStorage.removeItem("storageBrowser_currentPath")}catch(c){console.error("Error loading files:",c),alert("Error loading files: "+(((u=(i=c.response)==null?void 0:i.data)==null?void 0:u.error)||c.message))}finally{F.value=!1}}function S(i){y.value=i,ee()}function ne(i){if(i===0)return"0 Bytes";const u=1024,c=["Bytes","KB","MB","GB"],w=Math.floor(Math.log(i)/Math.log(u));return Math.round(i/Math.pow(u,w)*100)/100+" "+c[w]}function te(i){return i?new Date(i).toLocaleString():"-"}return _e(()=>f.selectedFiles,i=>{i&&(k.value=[...i])},{immediate:!0}),Ge(()=>{const i=localStorage.getItem("storageBrowser_currentPath");i&&(y.value=i),ee()}),(i,u)=>(n(),o("div",Gt,[t("div",Pt,[G(t("input",{"onUpdate:modelValue":u[0]||(u[0]=c=>I.value=c),type:"text",placeholder:"Search files and folders...",class:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"},null,512),[[ue,I.value]])]),t("div",Ft,[t("button",{onClick:u[1]||(u[1]=c=>S("")),class:"text-blue-600 hover:text-blue-800 cursor-pointer"}," Home "),y.value?(n(),o("span",Dt,"/")):h("",!0),(n(!0),o(W,null,V(j.value,(c,w)=>(n(),o(W,{key:w},[t("button",{onClick:Y=>S(U(w)),class:"text-blue-600 hover:text-blue-800 cursor-pointer"},d(c),9,jt),w<j.value.length-1?(n(),o("span",Bt,"/")):h("",!0)],64))),128))]),F.value?(n(),o("div",It," Loading... ")):C.value.length===0?(n(),o("div",Nt," This folder is empty ")):(n(),o("div",Wt,[t("table",Rt,[t("thead",Ut,[t("tr",null,[t("th",Lt,[t("input",{type:"checkbox",checked:b.value,onChange:H,class:"rounded border-gray-300"},null,40,Vt)]),u[3]||(u[3]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Name",-1)),u[4]||(u[4]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Size",-1)),u[5]||(u[5]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Modified",-1))])]),t("tbody",zt,[r.value.length===0&&I.value.trim()?(n(),o("tr",qt,[t("td",Ht,' No files or folders match "'+d(I.value)+'" ',1)])):(n(!0),o(W,{key:1},V(r.value,c=>(n(),o("tr",{key:c.path,class:fe(["hover:bg-gray-50",{"bg-blue-50":B(c)}])},[t("td",{class:"px-4 py-2",onClick:u[2]||(u[2]=Z(()=>{},["stop"]))},[c.isDirectory?h("",!0):(n(),o("input",{key:0,type:"checkbox",checked:B(c),onChange:w=>N(c),class:"rounded border-gray-300 cursor-pointer"},null,40,Kt))]),t("td",Ot,[t("div",Qt,[t("span",Yt,d(c.isDirectory?"ðŸ“":"ðŸ“„"),1),c.isDirectory?(n(),o("button",{key:0,onClick:w=>S(c.path),class:"text-blue-600 hover:text-blue-800 cursor-pointer"},d(c.name),9,Jt)):(n(),o("span",Xt,d(c.name),1))])]),t("td",Zt,d(c.isDirectory?"-":ne(c.size)),1),t("td",es,d(te(c.modified)),1)],2))),128))])])])),k.value.length>0?(n(),o("div",ts,[t("p",ss,d(k.value.length)+" file(s) selected ",1)])):h("",!0)]))}}),as={class:"px-4 py-6 sm:px-0"},os={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ns={class:"bg-white shadow rounded-lg p-6"},rs={class:"flex justify-between items-center mb-4"},is={class:"mb-4"},us={class:"flex gap-2"},ds=["value"],cs={class:"mt-4 p-4 bg-gray-50 rounded-md"},ps={class:"text-xs text-gray-600 space-y-1"},ms={class:"bg-white shadow rounded-lg p-6"},gs={class:"space-y-4"},vs={class:"flex gap-4"},fs={class:"flex items-center"},ys={class:"flex items-center"},xs={key:0},hs=["disabled"],bs={class:"mt-2"},ws={class:"flex items-center text-sm text-gray-700"},_s=["disabled"],ks={key:1},$s={class:"space-y-2"},Cs=["disabled"],Ss={class:"flex gap-2"},As=["disabled"],Ms=["disabled"],Ts={key:0,class:"mt-2 space-y-1"},Es={class:"flex items-center gap-2 flex-1 min-w-0"},Gs={class:"truncate"},Ps={class:"text-gray-400 text-xs"},Fs=["onClick"],Ds=["value"],js={key:0,class:"mt-2 text-sm text-gray-600"},Bs={class:"pt-4 border-t space-y-2"},Is=["disabled"],Ns={key:0,class:"flex items-center justify-center gap-2"},Ws={key:1},Rs={key:2},Us={key:0,class:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded text-sm"},Ls={class:"flex items-center gap-2"},Vs={class:"text-blue-800"},zs={class:"mt-2 w-full bg-gray-200 rounded-full h-2"},qs={key:1,class:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800"},Hs=["disabled"],Ks={class:"mt-6 bg-white shadow rounded-lg p-6"},Os={class:"flex justify-between items-center mb-4"},Qs={class:"flex gap-2"},Ys=["disabled"],Js={class:"relative top-10 mx-auto p-5 border w-full max-w-4xl shadow-lg rounded-md bg-white my-10 max-h-[90vh] overflow-y-auto"},Xs={class:"mt-3"},Zs={class:"flex justify-between items-center mb-4"},el={class:"mb-4 space-y-2"},tl={class:"flex gap-2"},sl=["value"],ll={key:0,class:"text-center py-8 text-gray-500"},al={key:1,class:"text-center py-8 text-gray-500"},ol={key:2,class:"border border-gray-200 rounded-md max-h-96 overflow-y-auto"},nl={class:"min-w-full divide-y divide-gray-200"},rl={class:"bg-gray-50 sticky top-0"},il={class:"px-4 py-2 text-left"},ul=["checked"],dl={class:"bg-white divide-y divide-gray-200"},cl=["onClick"],pl=["checked","onChange"],ml={class:"px-4 py-2 text-sm text-gray-900"},gl={class:"px-4 py-2 text-sm text-gray-500"},vl={class:"px-4 py-2 text-sm text-gray-500"},fl={class:"px-4 py-2 text-sm text-gray-500"},yl={class:"px-4 py-2 text-sm text-gray-500"},xl={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},hl={key:1,class:"text-gray-400"},bl={class:"mt-4 flex justify-between items-center"},wl={class:"text-sm text-gray-600"},_l={class:"flex gap-2"},kl={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},$l={class:"mt-3"},Cl={class:"mb-4"},Sl={class:"space-y-2"},Al={class:"flex items-center"},Ml={class:"flex items-center"},Tl={key:0,class:"mb-4"},El=["disabled"],Gl=["value"],Pl={key:1,class:"mt-2 text-sm text-gray-500"},Fl={key:1,class:"mb-4"},Dl={class:"mb-4 text-sm text-gray-500"},jl={class:"flex justify-end gap-2"},Bl=["disabled"],Il={class:"relative top-10 mx-auto p-5 border w-full max-w-4xl shadow-lg rounded-md bg-white my-10 max-h-[90vh] overflow-y-auto"},Nl={class:"mt-3"},Wl={class:"flex justify-between items-center mb-4"},Rl={class:"mt-4 flex justify-end gap-2"},Ul=["disabled"],Ll={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Vl={class:"mt-3"},zl={class:"mb-4"},ql={class:"flex justify-end gap-2"},Zl=ye({__name:"Messages",setup(z){const q=Je(),f=lt(),v=at();ot();const y=nt(),C=rt(),F=T(()=>f.template),k=T(()=>v.groups),I=T(()=>f.messages),R=T(()=>f.loading),j=T(()=>C.templates),b=p(null),r=p([]),U=p(null),B=p(!1),N=p(!1),H=p(""),ee=p(null),S=p([]),ne=p(!1),te=p(""),i=p(null),u=p(!1),c=p(!1),w=p("existing"),Y=p(null),se=p(""),xe=p([]),re=p(!1),de=p(!1),A=p("whatsapp"),le=p(""),he=p(!1),K=p([]),ce=p(null),pe=p(!1),ae=p(!1),J=p([]),L=p(!1),D=p({sent:0,total:0,current:""});T(()=>S.value.filter(l=>l.email&&l.email.trim()!=="")),T(()=>S.value.filter(l=>!l.email||l.email.trim()===""));const ke=T(()=>r.value.length===0?!0:S.value.filter(e=>r.value.includes(e.id)).every(e=>e.email&&e.email.trim()!=="")),$e=T(()=>{const l=F.value&&F.value.trim().length>0,e=b.value!==null||r.value.length>0,a=A.value==="whatsapp"||A.value==="email"&&le.value.trim().length>0;return A.value==="email"&&r.value.length>0&&!ke.value?!1:l&&e&&a}),Pe=T(()=>S.value.length>0&&S.value.every(l=>r.value.includes(l.id)));Ge(async()=>{if(await v.fetchGroups(),await f.fetchHistory(),await C.fetchTemplates(),await y.fetchStatus(),q.query.contactIds){const l=q.query.contactIds.split(",").map(e=>parseInt(e));r.value=l}q.query.messageType==="email"&&(A.value="email"),r.value.length>0&&await be()});async function be(){var l,e;ne.value=!0;try{const a={limit:1e3,offset:0};i.value&&(a.groupId=i.value),te.value&&(a.search=te.value);const s=await P.get("/api/contacts",{params:a});S.value=s.data.contacts}catch(a){console.error("Error loading contacts:",a),alert("Error loading contacts: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.error)||a.message))}finally{ne.value=!1}}async function Ce(){await be()}function Fe(l){if(l&&(b.value=null),l)S.value.forEach(e=>{r.value.includes(e.id)||r.value.push(e.id)});else{const e=S.value.map(a=>a.id);r.value=r.value.filter(a=>!e.includes(a))}}function De(){r.value=[]}function je(){b.value!==null&&(r.value=[])}function Se(l,e){e&&(b.value=null),e?r.value.includes(l)||r.value.push(l):r.value=r.value.filter(a=>a!==l)}_e(N,l=>{l&&be()});function Be(l){f.setTemplate(l)}function ie(l){ee.value&&ee.value.insertPlaceholder(l)}async function Ie(){var l,e,a,s,_,m,$;if($e.value){if(A.value==="whatsapp"){if(!y.connected){alert("WhatsApp is not connected. Please wait for the connection to be established. You can check the connection status in the Settings page.");return}try{const g=await f.sendMessages(r.value,b.value,F.value,1e3);alert(`Sent ${g.sent} messages successfully. ${g.failed} failed.`),await f.fetchHistory(),r.value=[],b.value=null}catch(g){alert("Error sending messages: "+(((e=(l=g.response)==null?void 0:l.data)==null?void 0:e.error)||g.message))}}else if(A.value==="email"){if(r.value.length===0&&b.value===null){alert("Please select at least one contact or group");return}let g=[];if(b.value!==null){if(k.value.find(x=>x.id===b.value))try{g=(await P.get("/api/contacts",{params:{groupId:b.value,limit:1e4}})).data.contacts||[]}catch(x){alert("Error loading group contacts: "+(((s=(a=x.response)==null?void 0:a.data)==null?void 0:s.error)||x.message));return}}else try{g=((await P.get("/api/contacts",{params:{limit:1e4}})).data.contacts||[]).filter(x=>r.value.includes(x.id))}catch(E){alert("Error loading contacts: "+(((m=(_=E.response)==null?void 0:_.data)==null?void 0:m.error)||E.message));return}if(g=g.filter(E=>E.email&&E.email.trim()!==""),g.length===0){alert("No contacts with email addresses found. Please select contacts that have email addresses.");return}if(!confirm(`Send email to ${g.length} contact(s)?`))return;L.value=!0,D.value={sent:0,total:g.length,current:""};let O=0,Q=0;try{for(let E=0;E<g.length;E++){const x=g[E];D.value.current=x.email||x.name||`Contact ${E+1}`,D.value.sent=O+Q;try{let M=F.value;M=M.replace(/{Name}/g,x.name||""),M=M.replace(/{GivenName}/g,(x.name||"").split(" ")[0]||""),M=M.replace(/{Business}/g,x.business||""),M=M.replace(/{Group}/g,x.group_id&&(($=k.value.find(oe=>oe.id===x.group_id))==null?void 0:$.name)||""),M=M.replace(/{Email}/g,x.email||"");let X=le.value||"Message from RoboDoc";if(he.value){const oe=Re();X=`${X} #${oe}`}await P.post("/api/email/send",{email:x.email,subject:X,message:M,contact_id:x.id,template_id:U.value,attachmentIds:K.value.length>0?K.value:void 0}),O++,D.value.sent=O+Q,await new Promise(oe=>setTimeout(oe,500))}catch(M){console.error(`Error sending email to ${x.email}:`,M),Q++,D.value.sent=O+Q}}alert(`Sent ${O} email(s) successfully. ${Q} failed.`),await f.fetchHistory(),r.value=[],b.value=null}finally{L.value=!1,D.value={sent:0,total:0,current:""}}}}}async function Ne(l){var s,_;const e=l.target;if(!e.files||e.files.length===0)return;const a=Array.from(e.files);if(K.value.length+a.length>10){alert("Maximum 10 attachments allowed. Please select fewer files.");return}pe.value=!0;try{const m=new FormData;a.forEach(g=>{m.append("attachments",g)});const $=await P.post("/api/attachments/upload",m,{headers:{"Content-Type":"multipart/form-data"}});K.value.push(...$.data.files),ce.value&&(ce.value.value="")}catch(m){alert("Error uploading attachments: "+(((_=(s=m.response)==null?void 0:s.data)==null?void 0:_.error)||m.message))}finally{pe.value=!1}}function We(l){K.value.splice(l,1)}function Re(){const l="abcdefghijklmnopqrstuvwxyz",e="0123456789";let a="";for(let s=0;s<3;s++)a+=l.charAt(Math.floor(Math.random()*l.length));for(let s=0;s<3;s++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}function Ue(l){if(l===0)return"0 Bytes";const e=1024,a=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(l)/Math.log(e));return Math.round(l/Math.pow(e,s)*100)/100+" "+a[s]}async function Le(l){var e,a;try{await f.retryMessage(l),alert("Message retried successfully"),await f.fetchHistory()}catch(s){alert("Error retrying message: "+(((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||s.message))}}async function Ve(l){var e,a;if(confirm("Are you sure you want to delete this message?"))try{await P.delete(`/api/messages/${l}`),await f.fetchHistory()}catch(s){alert("Error deleting message: "+(((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||s.message))}}async function ze(){var e,a;if(!(!confirm('Are you sure you want to delete ALL messages? This action cannot be undone. Type "DELETE ALL" to confirm.')||prompt('Type "DELETE ALL" to confirm:')!=="DELETE ALL")){u.value=!0;try{await P.delete("/api/messages/all"),await f.fetchHistory(),alert("All messages deleted successfully")}catch(s){alert("Error deleting messages: "+(((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||s.message))}finally{u.value=!1}}}async function qe(){var l,e;if(U.value)try{const a=await C.getTemplate(U.value);f.setTemplate(a.content),a.email_subject&&(le.value=a.email_subject)}catch(a){alert("Error loading template: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.error)||a.message))}}function He(){if(!F.value.trim()){alert("Please enter a message template first");return}B.value=!0,H.value=""}async function Ae(){var l,e;if(!H.value.trim()){alert("Please enter a template name");return}try{const a=A.value==="email"?le.value:void 0;await C.createTemplate(H.value,F.value,void 0,a),B.value=!1,H.value="",alert("Template saved successfully!")}catch(a){alert("Error saving template: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.error)||a.message))}}const Me=T(()=>r.value.length===0?!1:w.value==="existing"?Y.value!==null:se.value.trim().length>0);async function we(){var l,e;re.value=!0;try{const a=await P.get("/api/whatsapp/groups");xe.value=a.data.groups||[]}catch(a){console.error("Error loading WhatsApp groups:",a),alert("Error loading WhatsApp groups: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.error)||a.message))}finally{re.value=!1}}async function Ke(){var a,s,_;if(!Me.value){alert("Please fill in all required fields");return}if(!y.connected){alert("WhatsApp is not connected. Please wait for the connection to be established.");return}let l=[];try{l=((await P.get("/api/contacts",{params:{limit:1e4,offset:0}})).data.contacts||[]).filter($=>r.value.includes($.id))}catch(m){console.error("Error fetching contacts:",m),l=S.value.filter($=>r.value.includes($.id))}if(l.length===0){alert("No contacts found. Please try selecting contacts again.");return}l.length<r.value.length&&console.warn(`Only found ${l.length} of ${r.value.length} selected contacts`);const e=l.map(m=>m.phone).filter(m=>m);de.value=!0;try{if(w.value==="new"){const m=await P.post("/api/whatsapp/groups",{name:se.value.trim(),participantPhones:e});alert(`Successfully created WhatsApp group "${se.value}" and added ${e.length} contact(s)!`),se.value="",w.value="existing"}else{if(!Y.value){alert("Please select a group");return}const m=await P.post(`/api/whatsapp/groups/${Y.value}/participants`,{participantPhones:e}),$=((a=xe.value.find(g=>g.id===Y.value))==null?void 0:a.name)||"group";alert(`Successfully added ${e.length} contact(s) to WhatsApp group "${$}"!`)}await we(),c.value=!1}catch(m){alert("Error adding contacts to WhatsApp group: "+(((_=(s=m.response)==null?void 0:s.data)==null?void 0:_.error)||m.message))}finally{de.value=!1}}_e(c,l=>{l&&we()});function Oe(){ae.value=!0}function Qe(l){J.value=l}async function Ye(){var s,_;if(J.value.length===0)return;pe.value=!0;const l=J.value.filter(m=>!m.isDirectory),e=[],a=[];for(const m of l)try{const $=await P.get(`/api/storage/download?filePath=${encodeURIComponent(m.path)}`,{responseType:"blob",timeout:6e4});let g=m.name;const O=$.headers["content-disposition"];if(O){const X=O.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);if(X&&X[1]){g=X[1].replace(/['"]/g,"");try{g=decodeURIComponent(g)}catch{}}}const Q=$.data,E=new File([Q],g,{type:$.headers["content-type"]||Q.type||"application/octet-stream"}),x=new FormData;x.append("attachments",E);const M=await P.post("/api/attachments/upload",x,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4});K.value.push(...M.data.files),e.push(g)}catch($){console.error("Error adding storage file:",$);const g=((_=(s=$.response)==null?void 0:s.data)==null?void 0:_.error)||$.message||"Unknown error";a.push({name:m.name,error:g})}pe.value=!1,e.length>0&&a.length===0?alert(`Successfully added ${e.length} file(s) to attachments.`):e.length>0&&a.length>0?alert(`Added ${e.length} file(s) successfully. Failed to add ${a.length} file(s):
${a.map(m=>`- ${m.name}: ${m.error}`).join(`
`)}`):a.length>0&&alert(`Failed to add ${a.length} file(s):
${a.map(m=>`- ${m.name}: ${m.error}`).join(`
`)}`),J.value=[],ae.value=!1}return(l,e)=>{const a=Ze("router-link");return n(),o("div",as,[e[83]||(e[83]=t("div",{class:"mb-6"},[t("h2",{class:"text-3xl font-bold text-gray-900"},"Send Messages"),t("p",{class:"mt-1 text-sm text-gray-500"},"Compose and send WhatsApp messages to contacts")],-1)),t("div",os,[t("div",ns,[t("div",rs,[e[35]||(e[35]=t("h3",{class:"text-lg font-medium text-gray-900"},"Message Template",-1)),me(a,{to:"/templates",class:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer"},{default:Xe(()=>[...e[34]||(e[34]=[Te(" Manage Templates ",-1)])]),_:1})]),t("div",is,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Load Template",-1)),t("div",us,[G(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>U.value=s),class:"flex-1 border border-gray-300 rounded-md px-3 py-2",onChange:qe},[e[36]||(e[36]=t("option",{value:null},"-- Select Template --",-1)),(n(!0),o(W,null,V(j.value,s=>(n(),o("option",{key:s.id,value:s.id},d(s.name),9,ds))),128))],544),[[ge,U.value]]),t("button",{onClick:He,class:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm cursor-pointer"}," Save as Template ")])]),me(ct,{ref_key:"messageEditorRef",ref:ee,template:F.value,"onUpdate:template":Be},null,8,["template"]),t("div",cs,[e[48]||(e[48]=t("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Available placeholders (click to insert):",-1)),t("ul",ps,[t("li",null,[t("button",{onClick:e[1]||(e[1]=s=>ie("{Name}")),class:"hover:bg-green-100 transition-colors rounded px-1 py-0.5 cursor-pointer"},[...e[38]||(e[38]=[t("code",{class:"bg-white px-1 rounded cursor-pointer hover:bg-green-50"},"{Name}",-1)])]),e[39]||(e[39]=t("span",{class:"ml-1"},"- Full name",-1))]),t("li",null,[t("button",{onClick:e[2]||(e[2]=s=>ie("{GivenName}")),class:"hover:bg-green-100 transition-colors rounded px-1 py-0.5 cursor-pointer"},[...e[40]||(e[40]=[t("code",{class:"bg-white px-1 rounded cursor-pointer hover:bg-green-50"},"{GivenName}",-1)])]),e[41]||(e[41]=t("span",{class:"ml-1"},"- First name",-1))]),t("li",null,[t("button",{onClick:e[3]||(e[3]=s=>ie("{Business}")),class:"hover:bg-green-100 transition-colors rounded px-1 py-0.5 cursor-pointer"},[...e[42]||(e[42]=[t("code",{class:"bg-white px-1 rounded cursor-pointer hover:bg-green-50"},"{Business}",-1)])]),e[43]||(e[43]=t("span",{class:"ml-1"},"- Business/Institution",-1))]),t("li",null,[t("button",{onClick:e[4]||(e[4]=s=>ie("{Group}")),class:"hover:bg-green-100 transition-colors rounded px-1 py-0.5 cursor-pointer"},[...e[44]||(e[44]=[t("code",{class:"bg-white px-1 rounded cursor-pointer hover:bg-green-50"},"{Group}",-1)])]),e[45]||(e[45]=t("span",{class:"ml-1"},"- Group name",-1))]),t("li",null,[t("button",{onClick:e[5]||(e[5]=s=>ie("{Email}")),class:"hover:bg-green-100 transition-colors rounded px-1 py-0.5 cursor-pointer"},[...e[46]||(e[46]=[t("code",{class:"bg-white px-1 rounded cursor-pointer hover:bg-green-50"},"{Email}",-1)])]),e[47]||(e[47]=t("span",{class:"ml-1"},"- Email address",-1))])])])]),t("div",ms,[e[64]||(e[64]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Select Recipients",-1)),t("div",gs,[t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Message Type",-1)),t("div",vs,[t("label",fs,[G(t("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=s=>A.value=s),value:"whatsapp",class:"mr-2"},null,512),[[ve,A.value]]),e[49]||(e[49]=t("span",null,"WhatsApp",-1))]),t("label",ys,[G(t("input",{type:"radio","onUpdate:modelValue":e[7]||(e[7]=s=>A.value=s),value:"email",class:"mr-2"},null,512),[[ve,A.value]]),e[50]||(e[50]=t("span",null,"Email",-1))])])]),A.value==="email"?(n(),o("div",xs,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Subject",-1)),G(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>le.value=s),type:"text",disabled:L.value,class:"w-full border border-gray-300 rounded-md px-3 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter email subject"},null,8,hs),[[ue,le.value]]),t("div",bs,[t("label",ws,[G(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=s=>he.value=s),disabled:L.value,class:"mr-2 disabled:cursor-not-allowed"},null,8,_s),[[et,he.value]]),e[52]||(e[52]=t("span",null,"Add unique reference to prevent email threading",-1))]),e[53]||(e[53]=t("p",{class:"text-xs text-gray-500 mt-1 ml-6"}," When enabled, each email will get a unique code (e.g., #fcj837) appended to the subject ",-1))])])):h("",!0),A.value==="email"?(n(),o("div",ks,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Attachments (optional)",-1)),t("div",$s,[t("input",{ref_key:"fileInputRef",ref:ce,type:"file",multiple:"",onChange:Ne,disabled:L.value,class:"hidden",accept:"*/*"},null,40,Cs),t("div",Ss,[t("button",{type:"button",onClick:e[10]||(e[10]=s=>{var _;return(_=ce.value)==null?void 0:_.click()}),disabled:L.value,class:"flex-1 px-4 py-2 border-2 border-dashed border-gray-300 rounded-md hover:border-blue-500 hover:text-blue-600 disabled:bg-gray-100 disabled:cursor-not-allowed disabled:border-gray-200 cursor-pointer text-sm"}," + Upload New Files ",8,As),t("button",{type:"button",onClick:Oe,disabled:L.value,class:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer text-sm"}," ðŸ“ Choose from Storage ",8,Ms)]),K.value.length>0?(n(),o("div",Ts,[(n(!0),o(W,null,V(K.value,(s,_)=>(n(),o("div",{key:_,class:"flex items-center justify-between p-2 bg-gray-50 rounded-md text-sm"},[t("div",Es,[e[55]||(e[55]=t("span",{class:"text-gray-600"},"ðŸ“Ž",-1)),t("span",Gs,d(s.originalFilename||s.filename),1),t("span",Ps,"("+d(Ue(s.fileSize))+")",1)]),t("button",{type:"button",onClick:m=>We(_),class:"ml-2 text-red-600 hover:text-red-800 cursor-pointer",title:"Remove attachment"}," âœ• ",8,Fs)]))),128))])):h("",!0)]),e[57]||(e[57]=t("p",{class:"mt-1 text-xs text-gray-500"}," Maximum 25MB per file. Up to 10 files per email. ",-1))])):h("",!0),t("div",null,[e[59]||(e[59]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Send to App Group",-1)),G(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>b.value=s),class:"w-full border border-gray-300 rounded-md px-3 py-2",onChange:je},[e[58]||(e[58]=t("option",{value:null},"-- Select Group --",-1)),(n(!0),o(W,null,V(k.value,s=>(n(),o("option",{key:s.id,value:s.id},d(s.name)+" ("+d(s.contactCount||0)+" contacts) ",9,Ds))),128))],544),[[ge,b.value]])]),e[63]||(e[63]=t("div",{class:"text-center text-gray-500"},"OR",-1)),t("div",null,[e[60]||(e[60]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Individual Contacts",-1)),t("button",{onClick:e[12]||(e[12]=s=>N.value=!0),class:"block w-full text-center px-4 py-2 border-2 border-dashed border-gray-300 rounded-md hover:border-green-500 hover:text-green-600 cursor-pointer"}," Select Contacts "),r.value.length>0?(n(),o("div",js,d(r.value.length)+" contact(s) selected ",1)):h("",!0)]),t("div",Bs,[t("button",{onClick:Ie,disabled:!$e.value||R.value||L.value,class:"w-full px-4 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-medium cursor-pointer"},[L.value?(n(),o("span",Ns,[e[61]||(e[61]=t("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},null,-1)),Te(" Sending... ("+d(D.value.sent)+"/"+d(D.value.total)+") ",1)])):R.value?(n(),o("span",Ws," Sending... ")):(n(),o("span",Rs,d(A.value==="email"?"Send Emails":"Send Messages"),1))],8,Is),L.value&&D.value.current?(n(),o("div",Us,[t("div",Ls,[e[62]||(e[62]=t("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"},null,-1)),t("span",Vs,"Sending to: "+d(D.value.current),1)]),t("div",zs,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:tt({width:D.value.total>0?D.value.sent/D.value.total*100+"%":"0%"})},null,4)])])):h("",!0),A.value==="email"&&r.value.length>0&&!ke.value?(n(),o("div",qs," âš ï¸ Some selected contacts don't have email addresses. Please select only contacts with email addresses. ")):h("",!0),r.value.length>0?(n(),o("button",{key:2,onClick:e[13]||(e[13]=s=>c.value=!0),disabled:!Ee(y).connected,class:"w-full px-4 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-medium cursor-pointer"}," Add to WhatsApp Group ",8,Hs)):h("",!0)])])])]),t("div",Ks,[t("div",Os,[e[65]||(e[65]=t("h3",{class:"text-lg font-medium text-gray-900"},"Message History",-1)),t("div",Qs,[I.value.length>0?(n(),o("button",{key:0,onClick:ze,disabled:u.value,class:"px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},d(u.value?"Deleting...":"Delete All"),9,Ys)):h("",!0)])]),me(Et,{messages:I.value,onRetry:Le,onDelete:Ve},null,8,["messages"])]),N.value?(n(),o("div",{key:0,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:e[21]||(e[21]=Z(s=>N.value=!1,["self"]))},[t("div",Js,[t("div",Xs,[t("div",Zs,[e[66]||(e[66]=t("h3",{class:"text-lg font-medium text-gray-900"},"Select Contacts",-1)),t("button",{onClick:e[14]||(e[14]=s=>N.value=!1),class:"text-gray-400 hover:text-gray-600 cursor-pointer"}," âœ• ")]),t("div",el,[G(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>te.value=s),type:"text",placeholder:"Search contacts...",class:"w-full border border-gray-300 rounded-md px-3 py-2",onInput:Ce},null,544),[[ue,te.value]]),t("div",tl,[G(t("select",{"onUpdate:modelValue":e[16]||(e[16]=s=>i.value=s),class:"flex-1 border border-gray-300 rounded-md px-3 py-2",onChange:Ce},[e[67]||(e[67]=t("option",{value:null},"All Groups",-1)),(n(!0),o(W,null,V(k.value,s=>(n(),o("option",{key:s.id,value:s.id},d(s.name),9,sl))),128))],544),[[ge,i.value]])])]),ne.value?(n(),o("div",ll," Loading contacts... ")):S.value.length===0?(n(),o("div",al," No contacts found ")):(n(),o("div",ol,[t("table",nl,[t("thead",rl,[t("tr",null,[t("th",il,[t("input",{type:"checkbox",checked:Pe.value,onChange:Fe,class:"rounded border-gray-300"},null,40,ul)]),e[68]||(e[68]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Name",-1)),e[69]||(e[69]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Phone",-1)),e[70]||(e[70]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Group",-1)),e[71]||(e[71]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Business",-1)),e[72]||(e[72]=t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Messages",-1))])]),t("tbody",dl,[(n(!0),o(W,null,V(S.value,s=>(n(),o("tr",{key:s.id,onClick:_=>Se(s.id,!r.value.includes(s.id)),class:fe(["hover:bg-gray-50 cursor-pointer transition-colors",{"bg-blue-50":r.value.includes(s.id)}])},[t("td",{class:"px-4 py-2",onClick:e[18]||(e[18]=Z(()=>{},["stop"]))},[t("input",{type:"checkbox",checked:r.value.includes(s.id),onChange:_=>Se(s.id,_.target.checked),onClick:e[17]||(e[17]=Z(()=>{},["stop"])),class:"rounded border-gray-300 cursor-pointer"},null,40,pl)]),t("td",ml,d(s.name),1),t("td",gl,d(Ee(it)(s.phone)),1),t("td",vl,d(s.group_name||"-"),1),t("td",fl,d(s.business||"-"),1),t("td",yl,[s.sent_count&&s.sent_count>0?(n(),o("span",xl," Sent ("+d(s.sent_count)+") ",1)):(n(),o("span",hl,"-"))])],10,cl))),128))])])])),t("div",bl,[t("div",wl,d(r.value.length)+" contact(s) selected ",1),t("div",_l,[r.value.length>0?(n(),o("button",{key:0,onClick:e[19]||(e[19]=s=>c.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer"}," Add to WhatsApp Group ")):h("",!0),t("button",{onClick:De,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Clear Selection "),t("button",{onClick:e[20]||(e[20]=s=>N.value=!1),class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer"}," Done ")])])])])])):h("",!0),c.value?(n(),o("div",{key:1,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:e[27]||(e[27]=Z(s=>c.value=!1,["self"]))},[t("div",kl,[t("div",$l,[e[79]||(e[79]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Add to WhatsApp Group",-1)),t("div",Cl,[e[75]||(e[75]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Action *",-1)),t("div",Sl,[t("label",Al,[G(t("input",{type:"radio","onUpdate:modelValue":e[22]||(e[22]=s=>w.value=s),value:"existing",class:"mr-2"},null,512),[[ve,w.value]]),e[73]||(e[73]=t("span",null,"Add to existing group",-1))]),t("label",Ml,[G(t("input",{type:"radio","onUpdate:modelValue":e[23]||(e[23]=s=>w.value=s),value:"new",class:"mr-2"},null,512),[[ve,w.value]]),e[74]||(e[74]=t("span",null,"Create new group",-1))])])]),w.value==="existing"?(n(),o("div",Tl,[e[77]||(e[77]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select WhatsApp Group *",-1)),G(t("select",{"onUpdate:modelValue":e[24]||(e[24]=s=>Y.value=s),class:"w-full border border-gray-300 rounded-md px-3 py-2",disabled:re.value},[e[76]||(e[76]=t("option",{value:null},"-- Select Group --",-1)),(n(!0),o(W,null,V(xe.value,s=>(n(),o("option",{key:s.id,value:s.id},d(s.name)+" ("+d(s.participantCount)+" participants) ",9,Gl))),128))],8,El),[[ge,Y.value]]),re.value?h("",!0):(n(),o("button",{key:0,onClick:we,class:"mt-2 text-sm text-blue-600 hover:text-blue-800 cursor-pointer"}," Refresh Groups ")),re.value?(n(),o("p",Pl,"Loading groups...")):h("",!0)])):h("",!0),w.value==="new"?(n(),o("div",Fl,[e[78]||(e[78]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Group Name *",-1)),G(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>se.value=s),type:"text",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Enter group name"},null,512),[[ue,se.value]])])):h("",!0),t("p",Dl,d(r.value.length)+" contact(s) will be "+d(w.value==="new"?"added to the new":"added to the selected")+" group ",1),t("div",jl,[t("button",{type:"button",onClick:e[26]||(e[26]=s=>c.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Cancel "),t("button",{onClick:Ke,disabled:!Me.value||de.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},d(de.value?"Adding...":w.value==="new"?"Create Group":"Add to Group"),9,Bl)])])])])):h("",!0),ae.value?(n(),o("div",{key:2,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:e[30]||(e[30]=Z(s=>ae.value=!1,["self"]))},[t("div",Il,[t("div",Nl,[t("div",Wl,[e[80]||(e[80]=t("h3",{class:"text-lg font-medium text-gray-900"},"Select Files from Storage",-1)),t("button",{onClick:e[28]||(e[28]=s=>ae.value=!1),class:"text-gray-400 hover:text-gray-600 cursor-pointer text-2xl"}," âœ• ")]),me(ls,{onFileSelected:Qe,"selected-files":J.value},null,8,["selected-files"]),t("div",Rl,[t("button",{onClick:e[29]||(e[29]=s=>ae.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Cancel "),t("button",{onClick:Ye,disabled:J.value.length===0,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"}," Add Selected ("+d(J.value.length)+") ",9,Ul)])])])])):h("",!0),B.value?(n(),o("div",{key:3,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:e[33]||(e[33]=Z(s=>B.value=!1,["self"]))},[t("div",Ll,[t("div",Vl,[e[82]||(e[82]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Save as Template",-1)),t("div",zl,[e[81]||(e[81]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Template Name *",-1)),G(t("input",{"onUpdate:modelValue":e[31]||(e[31]=s=>H.value=s),type:"text",required:"",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"e.g., Welcome Message",onKeyup:st(Ae,["enter"])},null,544),[[ue,H.value]])]),t("div",ql,[t("button",{type:"button",onClick:e[32]||(e[32]=s=>B.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Cancel "),t("button",{onClick:Ae,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer"}," Save Template ")])])])])):h("",!0)])}}});export{Zl as default};
