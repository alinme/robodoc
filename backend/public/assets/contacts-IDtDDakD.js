import{u as x,r as l,i as A,e as c}from"./index-D6DdudHB.js";const u="/api",G=x("contacts",()=>{const o=l([]),v=l([]),p=l(!1),f=l(null),i=l(0),n=l({groupId:null,business:"",search:""});async function h(e=100,s=0){var a,r;p.value=!0,f.value=null;try{const t={limit:e,offset:s};n.value.groupId&&(t.groupId=n.value.groupId),n.value.business&&(t.business=n.value.business),n.value.search&&(t.search=n.value.search);const d=await c.get(`${u}/contacts`,{params:t});o.value=d.data.contacts,i.value=d.data.total}catch(t){f.value=((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.error)||t.message,console.error("Error fetching contacts:",t)}finally{p.value=!1}}async function g(){try{const e=await c.get(`${u}/groups`);v.value=e.data.groups}catch(e){console.error("Error fetching groups:",e)}}async function w(e,s){var a,r;try{const t=await c.post(`${u}/groups`,{name:e,description:s});return await g(),t.data.group}catch(t){throw new Error(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.error)||t.message)}}async function y(e,s){var a,r;try{const t=await c.put(`${u}/contacts/${e}`,s),d=o.value.findIndex(I=>I.id===e);return d!==-1&&(o.value[d]=t.data.contact),t.data.contact}catch(t){throw new Error(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.error)||t.message)}}async function m(e){var s,a;try{await c.delete(`${u}/contacts/${e}`),o.value=o.value.filter(r=>r.id!==e),i.value--}catch(r){throw new Error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||r.message)}}async function $(){var e,s;try{const a=await c.delete(`${u}/contacts/all`);return o.value=[],i.value=0,a.data.deleted}catch(a){throw new Error(((s=(e=a.response)==null?void 0:e.data)==null?void 0:s.error)||a.message)}}async function E(e){var s,a;try{const r=await c.delete(`${u}/contacts/bulk`,{data:{contactIds:e}});return o.value=o.value.filter(t=>!e.includes(t.id)),i.value-=r.data.deleted,r.data.deleted}catch(r){throw new Error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||r.message)}}function C(e){n.value={...n.value,...e}}const b=A(()=>o.value);return{contacts:o,groups:v,loading:p,error:f,total:i,filters:n,filteredContacts:b,fetchContacts:h,fetchGroups:g,createGroup:w,updateContact:y,deleteContact:m,deleteAllContacts:$,deleteContacts:E,setFilters:C}});export{G as u};
