import{u as m,r as t,e as g}from"./index-D6DdudHB.js";const p="/api",q=m("whatsapp",()=>{const n=t("disconnected"),d=t(!1),o=t(null),l=t(null),r=t(!1),c=t(null);let s=null;async function u(){try{const a=await g.get(`${p}/whatsapp/status`);n.value=a.data.status,d.value=a.data.connected}catch(a){console.error("Error fetching WhatsApp status:",a)}}async function i(){var a,f;r.value=!0,c.value=null;try{const e=await g.get(`${p}/whatsapp/qr`);console.log("QR Code response:",e.data),e.data.success&&(e.data.image||e.data.qr)?(o.value=e.data.qr,l.value=e.data.image,console.log("QR Code image set, length:",e.data.image?e.data.image.length:0)):n.value!=="connecting"&&(o.value=null,l.value=null)}catch(e){c.value=((f=(a=e.response)==null?void 0:a.data)==null?void 0:f.error)||e.message,console.error("Error fetching QR code:",e)}finally{r.value=!1}}function v(){s||(u(),i(),s=window.setInterval(()=>{u(),(n.value==="connecting"||n.value==="disconnected")&&i()},2e3))}function h(){s&&(clearInterval(s),s=null)}return{status:n,connected:d,qrCode:o,qrCodeImage:l,loading:r,error:c,fetchStatus:u,fetchQRCode:i,startPolling:v,stopPolling:h}});export{q as u};
