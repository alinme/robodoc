import{d as B,i as T,r as c,o as U,c as a,a as t,f as k,F as V,b as D,s as C,t as m,j as b,v as g,k as y,h as r}from"./index-D6DdudHB.js";import{u as L}from"./templates-TDtG4Si1.js";const $={class:"px-4 py-6 sm:px-0"},G={class:"mb-6 flex justify-between items-center"},O={class:"bg-white shadow rounded-lg overflow-hidden"},H={key:0,class:"p-6 text-center text-gray-500"},q={key:1,class:"p-6 text-center text-gray-500"},A={key:2,class:"divide-y divide-gray-200"},F={class:"flex justify-between items-start"},R={class:"flex-1"},Y={class:"text-lg font-medium text-gray-900"},P={class:"mt-2 p-3 bg-gray-50 rounded-md"},W={class:"text-sm text-gray-700 whitespace-pre-wrap"},z={class:"mt-2 text-xs text-gray-500"},I={key:0},J={class:"ml-4 flex gap-2"},K=["onClick"],Q=["onClick"],X={class:"relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white my-10"},Z={class:"mt-3"},ee={class:"text-lg font-medium text-gray-900 mb-4"},te={class:"space-y-4"},oe={class:"mt-2"},le={class:"flex flex-wrap gap-2 text-xs"},se={class:"flex justify-end gap-2 mt-6"},ae=["disabled"],ie=B({__name:"Templates",setup(re){const d=L(),h=T(()=>d.templates),j=T(()=>d.loading),x=c(!1),n=c(null),v=c(!1),l=c({name:"",content:"",html_template:"",email_subject:""}),i=c(null);U(async()=>{await d.fetchTemplates()});function N(s){n.value=s,l.value={name:s.name,content:s.content,html_template:s.html_template||"",email_subject:s.email_subject||""}}function f(){x.value=!1,n.value=null,l.value={name:"",content:"",html_template:"",email_subject:""}}async function S(){var s,e;if(!l.value.name.trim()||!l.value.content.trim()){alert("Template name and content are required");return}v.value=!0;try{n.value?await d.updateTemplate(n.value.id,l.value.name,l.value.content,l.value.html_template,l.value.email_subject):await d.createTemplate(l.value.name,l.value.content,l.value.html_template,l.value.email_subject),f()}catch(o){alert("Error saving template: "+(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.error)||o.message))}finally{v.value=!1}}async function E(s){var e,o;if(confirm("Are you sure you want to delete this template?"))try{await d.deleteTemplate(s)}catch(u){alert("Error deleting template: "+(((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.error)||u.message))}}function p(s){if(!i.value)return;const e=i.value;e.focus();const o=e.selectionStart||0,u=e.selectionEnd||o,w=l.value.content||"",M=w.substring(0,o)+s+w.substring(u);l.value.content=M,setTimeout(()=>{if(i.value){i.value.focus();const _=o+s.length;i.value.setSelectionRange(_,_)}},10)}return(s,e)=>(r(),a("div",$,[t("div",G,[e[10]||(e[10]=t("div",null,[t("h2",{class:"text-3xl font-bold text-gray-900"},"Message Templates"),t("p",{class:"mt-1 text-sm text-gray-500"},"Create and manage message templates")],-1)),t("button",{onClick:e[0]||(e[0]=o=>x.value=!0),class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer"}," + New Template ")]),t("div",O,[j.value?(r(),a("div",H," Loading templates... ")):h.value.length===0?(r(),a("div",q," No templates yet. Create your first template! ")):(r(),a("div",A,[(r(!0),a(V,null,D(h.value,o=>(r(),a("div",{key:o.id,class:"p-6 hover:bg-gray-50"},[t("div",F,[t("div",R,[t("h3",Y,m(o.name),1),t("div",P,[t("pre",W,m(o.content),1)]),t("p",z,[y(" Created: "+m(new Date(o.created_at).toLocaleString())+" ",1),o.updated_at!==o.created_at?(r(),a("span",I," | Updated: "+m(new Date(o.updated_at).toLocaleString()),1)):k("",!0)])]),t("div",J,[t("button",{onClick:u=>N(o),class:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 cursor-pointer"}," Edit ",8,K),t("button",{onClick:u=>E(o.id),class:"px-3 py-1 bg-red-600 text-white text-sm rounded-md hover:bg-red-700 cursor-pointer"}," Delete ",8,Q)])])]))),128))]))]),x.value||n.value?(r(),a("div",{key:0,class:"fixed inset-0 bg-gray-600/75 overflow-y-auto h-full w-full z-50",onClick:C(f,["self"])},[t("div",X,[t("div",Z,[t("h3",ee,m(n.value?"Edit Template":"New Template"),1),t("form",{onSubmit:C(S,["prevent"])},[t("div",te,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Template Name *",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.name=o),type:"text",required:"",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"e.g., Welcome Message"},null,512),[[g,l.value.name]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Subject (Optional)",-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.email_subject=o),type:"text",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"e.g., Welcome to Our Service"},null,512),[[g,l.value.email_subject]]),e[13]||(e[13]=t("p",{class:"mt-1 text-xs text-gray-500"},"This subject will be automatically loaded when you select this template",-1))]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Template Content *",-1)),b(t("textarea",{ref_key:"textareaRef",ref:i,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.content=o),required:"",rows:"10",class:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Enter your message template. Use {Name}, {GivenName}, {Business}, {Group}, {Email} as placeholders."},null,512),[[g,l.value.content]]),t("div",oe,[e[19]||(e[19]=t("p",{class:"text-xs font-medium text-gray-700 mb-1"},"Available placeholders (click to insert):",-1)),t("div",le,[t("button",{type:"button",onClick:e[4]||(e[4]=o=>p("{Name}")),class:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-green-50 hover:border-green-300 transition-colors cursor-pointer"},[...e[14]||(e[14]=[t("code",null,"{Name}",-1)])]),t("button",{type:"button",onClick:e[5]||(e[5]=o=>p("{GivenName}")),class:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-green-50 hover:border-green-300 transition-colors cursor-pointer"},[...e[15]||(e[15]=[t("code",null,"{GivenName}",-1)])]),t("button",{type:"button",onClick:e[6]||(e[6]=o=>p("{Business}")),class:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-green-50 hover:border-green-300 transition-colors cursor-pointer"},[...e[16]||(e[16]=[t("code",null,"{Business}",-1)])]),t("button",{type:"button",onClick:e[7]||(e[7]=o=>p("{Group}")),class:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-green-50 hover:border-green-300 transition-colors cursor-pointer"},[...e[17]||(e[17]=[t("code",null,"{Group}",-1)])]),t("button",{type:"button",onClick:e[8]||(e[8]=o=>p("{Email}")),class:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-green-50 hover:border-green-300 transition-colors cursor-pointer"},[...e[18]||(e[18]=[t("code",null,"{Email}",-1)])])])])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[y(" HTML Template (Optional) "),t("span",{class:"text-xs text-gray-500 ml-2"},"Use {BODY} placeholder to insert the text template above")],-1)),b(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=o=>l.value.html_template=o),rows:"15",class:"w-full border border-gray-300 rounded-md px-3 py-2 font-mono text-sm",placeholder:"<html><head><style>...</style></head><body><header>...</header>{BODY}<footer>...</footer></body></html>"},null,512),[[g,l.value.html_template]]),e[22]||(e[22]=t("div",{class:"mt-2"},[t("p",{class:"text-xs text-gray-500"},[y(" The HTML template will wrap your text template. Use "),t("code",{class:"bg-gray-100 px-1 rounded"},"{BODY}"),y(" to insert the text content. If no HTML template is provided, the text will be converted to HTML automatically. ")])],-1))])]),t("div",se,[t("button",{type:"button",onClick:f,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 cursor-pointer"}," Cancel "),t("button",{type:"submit",disabled:v.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed cursor-pointer"},m(v.value?"Saving...":n.value?"Update Template":"Create Template"),9,ae)])],32)])])])):k("",!0)]))}});export{ie as default};
